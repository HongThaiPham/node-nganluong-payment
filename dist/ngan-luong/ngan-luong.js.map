{"version":3,"sources":["../../src/ngan-luong/ngan-luong.js"],"names":["NganLuong","constructor","config","Object","assign","buildCheckoutUrl","payload","Promise","resolve","reject","data","checkoutPayloadDefaults","nganluongSecretKey","secureSecret","nganluongMerchant","merchant","receiverEmail","validateCheckoutPayload","error","message","arrParam","function","nganluongCommand","cur_code","currency","toLowerCase","version","nganluongVersion","merchant_id","receiver_email","merchant_password","order_code","orderId","total_amount","String","amount","payment_method","paymentMethod","bank_code","bankCode","payment_type","paymentType","order_description","orderInfo","tax_amount","taxAmount","fee_shipping","feeShipping","discount_amount","discountAmount","return_url","returnUrl","cancel_url","cancelUrl","buyer_fullname","customerName","buyer_email","customerEmail","buyer_mobile","customerPhone","buyer_address","billingStreet","time_limit","timeLimit","lang_code","locale","affiliate_code","affiliateCode","total_item","totalItem","url","paymentGateway","params","keys","forEach","key","value","length","push","encodeURI","options","method","axios","post","join","then","rs","err","result","objectResponse","error_code","href","checkout_url","Error","description","checkoutSchema","validate","CURRENCY_VND","LOCALE_VN","VERSION","COMMAND","verifyReturnUrl","query","token","token_nl","isSuccess","encodeURIComponent","returnObject","_mapQueryToObject","getReturnUrlStatus","transactionId","responseCode","transaction_status","gatewayTransactionNo","transaction_id","responseCodeTable","vn","en","default","respondText","SimpleSchema","createdDate","type","optional","Integer","clientIp","max","allowedValues","billingCity","billingCountry","billingPostCode","billingStateProvince","customerId","deliveryAddress","deliveryCity","deliveryCountry","deliveryProvince","regEx","RegEx","Email","custom","shouldBeRequired","field","indexOf","ErrorTypes","REQUIRED","undefined","configSchema","Url","LOCALE_EN"],"mappings":"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","sourcesContent":["/*\n * @Author: leopham - hongthaipro@gmail.com\n * @Date: 2019-01-05 10:59:56\n * @Last Modified by: leopham - hongthaipro@gmail.com\n * @Last Modified time: 2019-01-05 14:14:59\n */\nimport SimpleSchema from 'simpl-schema';\nimport axios from 'axios';\nimport { parseString } from 'xml2js';\nimport { createMd5Hash } from '../utils';\n\nclass NganLuong {\n  constructor(config) {\n    this.config = Object.assign({}, config);\n  }\n\n  buildCheckoutUrl(payload) {\n    return new Promise((resolve, reject) => {\n      // Object tham số chuyển tới NganLuong Payment\n      const data = Object.assign({}, this.checkoutPayloadDefaults, payload);\n      const config = this.config;\n\n      data.nganluongSecretKey = config.secureSecret;\n      data.nganluongMerchant = config.merchant;\n      data.receiverEmail = config.receiverEmail;\n\n      // Input type checking\n      try {\n        this.validateCheckoutPayload(data);\n      } catch (error) {\n        reject(error.message);\n      }\n\n      // Step 1: Map data to ngan luong checkout params\n      /* prettier-ignore */\n      const arrParam = {\n\t\t\t\tfunction               : data.nganluongCommand,\n\t\t\t\tcur_code               : data.currency ? data.currency.toLowerCase() : 'vnd',\n\t\t\t\tversion                : data.nganluongVersion,\n\t\t\t\tmerchant_id            : data.nganluongMerchant,\n\t\t\t\treceiver_email         : data.receiverEmail,\n\t\t\t\tmerchant_password      : createMd5Hash(data.nganluongSecretKey),\n\t\t\t\torder_code             : data.orderId,\n\t\t\t\ttotal_amount           : String(data.amount),\n\t\t\t\tpayment_method         : data.paymentMethod,\n\t\t\t\tbank_code              : data.bankCode,\n\t\t\t\tpayment_type           : data.paymentType,\n\t\t\t\torder_description      : data.orderInfo,\n\t\t\t\ttax_amount             : data.taxAmount,\n\t\t\t\tfee_shipping           : data.feeShipping || '0',\n\t\t\t\tdiscount_amount        : data.discountAmount || '0',\n\t\t\t\treturn_url             : data.returnUrl,\n\t\t\t\tcancel_url             : data.cancelUrl,\n\t\t\t\tbuyer_fullname         : data.customerName,\n\t\t\t\tbuyer_email            : data.customerEmail,\n\t\t\t\tbuyer_mobile           : data.customerPhone,\n\t\t\t\tbuyer_address          : data.billingStreet,\n\t\t\t\ttime_limit             : data.timeLimit,\n\t\t\t\tlang_code              : data.locale,\n\t\t\t\taffiliate_code         : data.affiliateCode,\n\t\t\t\ttotal_item             : data.totalItem,\n\t\t\t};\n\n      // Step 2: Post checkout data to ngan luong server\n      const url = config.paymentGateway;\n      const params = [];\n      Object.keys(arrParam).forEach(key => {\n        const value = arrParam[key];\n\n        if (value == null || value.length === 0) {\n          // skip empty params (but they must be optional)\n          return;\n        }\n\n        if (value.length > 0) {\n          params.push(`${key}=${encodeURI(value)}`);\n        }\n      });\n\n      const options = {\n        method: 'POST'\n      };\n\n      axios.post(`${url}?${params.join('&')}`).then(rs => {\n        parseString(rs.data, (err, result) => {\n          const objectResponse = result.result || {};\n          if (objectResponse.error_code[0] === '00') {\n            resolve({\n              href: objectResponse.checkout_url[0]\n            });\n          } else {\n            reject(new Error(objectResponse.description[0]));\n          }\n        });\n      });\n    });\n  }\n\n  validateCheckoutPayload(payload) {\n    NganLuong.checkoutSchema.validate(payload);\n  }\n  get checkoutPayloadDefaults() {\n    /* prettier-ignore */\n    return {\n\t\t\tcurrency             : NganLuong.CURRENCY_VND,\n\t\t\tlocale               : NganLuong.LOCALE_VN,\n\t\t\tnganluongVersion     : NganLuong.VERSION,\n\t\t\tnganluongCommand\t : NganLuong.COMMAND,\n\t\t};\n  }\n\n  verifyReturnUrl(query) {\n    return new Promise(resolve => {\n      const data = {};\n      const config = this.config;\n      const token = query.token || query.token_nl;\n      if (!token) {\n        resolve({\n          isSuccess: false,\n          message: 'No token found'\n        });\n      }\n      data.nganluongSecretKey = config.secureSecret;\n      data.nganluongMerchant = config.merchant;\n      data.receiverEmail = config.receiverEmail;\n\n      // Step 1: Map data to ngan luong get detail params\n      /* prettier-ignore */\n      const arrParam = {\n\t\t\t\tmerchant_id            : data.nganluongMerchant,\n\t\t\t\tmerchant_password      : createMd5Hash(data.nganluongSecretKey),\n\t\t\t\tversion                : data.nganluongVersion,\n\t\t\t\tfunction               : 'GetTransactionDetail',\n\t\t\t\ttoken,\n\t\t\t};\n\n      // Step 2: Post checkout data to ngan luong server\n      const url = config.paymentGateway;\n      const params = [];\n      Object.keys(arrParam).forEach(key => {\n        const value = arrParam[key];\n\n        if (value == null || value.length === 0) {\n          // skip empty params (but they must be optional)\n          return;\n        }\n\n        if (value.length > 0) {\n          params.push(`${key}=${encodeURIComponent(value)}`);\n        }\n      });\n\n      axios.post(`${url}?${params.join('&')}`).then(rs => {\n        parseString(rs.data, (err, result) => {\n          const objectResponse = result.result || {};\n          if (objectResponse.error_code[0] === '00') {\n            objectResponse.merchant = data.nganluongMerchant;\n            const returnObject = this._mapQueryToObject(objectResponse);\n            resolve(Object.assign({}, returnObject, { isSuccess: true }));\n          } else {\n            resolve({\n              isSuccess: false,\n              message:\n                objectResponse.description ||\n                NganLuong.getReturnUrlStatus(objectResponse.error_code[0])\n            });\n          }\n        });\n      });\n    });\n  }\n\n  _mapQueryToObject(query) {\n    const returnObject = {};\n    Object.keys(query).forEach(key => {\n      returnObject[key] = query[key][0];\n    });\n\n    return Object.assign({}, returnObject, {\n      merchant: returnObject.merchant,\n      transactionId: returnObject.order_code,\n      amount: returnObject.total_amount,\n      orderInfo: returnObject.order_description,\n      responseCode: returnObject.transaction_status,\n      bankCode: returnObject.bank_code,\n      gatewayTransactionNo: returnObject.transaction_id,\n      message:\n        returnObject.description ||\n        NganLuong.getReturnUrlStatus(returnObject.error_code),\n      customerEmail: returnObject.buyer_email,\n      customerPhone: returnObject.buyer_mobile,\n      customerName: returnObject.buyer_fullname\n    });\n  }\n\n  static getReturnUrlStatus(responseCode, locale = 'vn') {\n    const responseCodeTable = {\n      '00': {\n        vn: 'Giao dịch thành công',\n        en: 'Approved'\n      },\n      '02': {\n        vn: 'Địa chỉ IP của merchant gọi tới NganLuong.vn không được chấp nhận',\n        en: 'Invalid IP Address'\n      },\n      '03': {\n        vn:\n          'Sai tham số gửi tới NganLuong.vn (có tham số sai tên hoặc kiểu dữ liệu)',\n        en: 'Sent data is not in the right format'\n      },\n      '04': {\n        vn: 'Tên hàm API do merchant gọi tới không hợp lệ (không tồn tại)',\n        en: 'API function name not found'\n      },\n      '05': {\n        vn: 'Sai version của API',\n        en: 'Wrong API version'\n      },\n      '06': {\n        vn: 'Mã merchant không tồn tại hoặc chưa được kích hoạt',\n        en: 'Merchant code not found or not activated yet'\n      },\n      '07': {\n        vn: 'Sai mật khẩu của merchant',\n        en: 'Wrong merchant password'\n      },\n      '08': {\n        vn: 'Tài khoản người bán hàng không tồn tại',\n        en: 'Seller account not found'\n      },\n      '09': {\n        vn: 'Tài khoản người nhận tiền đang bị phong tỏa',\n        en: 'Receiver account is frozen'\n      },\n      10: {\n        vn: 'Hóa đơn thanh toán không hợp lệ',\n        en: 'Invalid payment bill'\n      },\n      11: {\n        vn: 'Số tiền thanh toán không hợp lệ',\n        en: 'Invalid amount'\n      },\n      12: {\n        vn: 'Đơn vị tiền tệ không hợp lệ',\n        en: 'Invalid money currency'\n      },\n      29: {\n        vn: 'Token không tồn tại',\n        en: 'Token not found'\n      },\n      80: {\n        vn: 'Không thêm được đơn hàng',\n        en: \"Can't add more order\"\n      },\n      81: {\n        vn: 'Đơn hàng chưa được thanh toán',\n        en: 'The order has not yet been paid'\n      },\n      110: {\n        vn: 'Địa chỉ email tài khoản nhận tiền không phải email chính',\n        en: 'The email address is not the primary email'\n      },\n      111: {\n        vn: 'Tài khoản nhận tiền đang bị khóa',\n        en: 'Receiver account is locked'\n      },\n      113: {\n        vn: 'Tài khoản nhận tiền chưa cấu hình là người bán nội dung số',\n        en: 'Receiver account is not configured as digital content sellers'\n      },\n      114: {\n        vn: 'Giao dịch đang thực hiện, chưa kết thúc',\n        en: 'Pending transaction'\n      },\n      115: {\n        vn: 'Giao dịch bị hủy',\n        en: 'Cancelled transaction'\n      },\n      118: {\n        vn: 'tax_amount không hợp lệ',\n        en: 'Invalid tax_amount'\n      },\n      119: {\n        vn: 'discount_amount không hợp lệ',\n        en: 'Invalid discount_amount'\n      },\n      120: {\n        vn: 'fee_shipping không hợp lệ',\n        en: 'Invalid fee_shipping'\n      },\n      121: {\n        vn: 'return_url không hợp lệ',\n        en: 'Invalid return_url'\n      },\n      122: {\n        vn: 'cancel_url không hợp lệ',\n        en: 'Invalid cancel_url'\n      },\n      123: {\n        vn: 'items không hợp lệ',\n        en: 'Invalid items'\n      },\n      124: {\n        vn: 'transaction_info không hợp lệ',\n        en: 'Invalid transaction_info'\n      },\n      125: {\n        vn: 'quantity không hợp lệ',\n        en: 'Invalid quantity'\n      },\n      126: {\n        vn: 'order_description không hợp lệ',\n        en: 'Invalid order_description'\n      },\n      127: {\n        vn: 'affiliate_code không hợp lệ',\n        en: 'Invalid affiliate_code'\n      },\n      128: {\n        vn: 'time_limit không hợp lệ',\n        en: 'Invalid time_limit'\n      },\n      129: {\n        vn: 'buyer_fullname không hợp lệ',\n        en: 'Invalid buyer_fullname'\n      },\n      130: {\n        vn: 'buyer_email không hợp lệ',\n        en: 'Invalid buyer_email'\n      },\n      131: {\n        vn: 'buyer_mobile không hợp lệ',\n        en: 'Invalid buyer_mobile'\n      },\n      132: {\n        vn: 'buyer_address không hợp lệ',\n        en: 'Invalid buyer_address'\n      },\n      133: {\n        vn: 'total_item không hợp lệ',\n        en: 'Invalid total_item'\n      },\n      134: {\n        vn: 'payment_method, bank_code không hợp lệ',\n        en: 'Invalid payment_method, bank_code'\n      },\n      135: {\n        vn: 'Lỗi kết nối tới hệ thống ngân hàng',\n        en: 'Error connecting to banking system'\n      },\n      140: {\n        vn: 'Đơn hàng không hỗ trợ thanh toán trả góp',\n        en: 'The order does not support installment payments'\n      },\n      99: {\n        vn: 'Lỗi không được định nghĩa hoặc không rõ nguyên nhân',\n        en: 'Unknown error'\n      },\n      default: {\n        vn: 'Giao dịch thất bại',\n        en: 'Failured'\n      }\n    };\n\n    const respondText = responseCodeTable[responseCode];\n\n    return respondText\n      ? respondText[locale]\n      : responseCodeTable.default[locale];\n  }\n}\n\nNganLuong.checkoutSchema = new SimpleSchema({\n  createdDate: { type: String, optional: true },\n  amount: { type: SimpleSchema.Integer },\n  clientIp: { type: String, optional: true, max: 16 },\n  currency: { type: String, allowedValues: ['vnd', 'VND', 'USD', 'usd'] },\n  billingCity: { type: String, optional: true, max: 255 },\n  billingCountry: { type: String, optional: true, max: 255 },\n  billingPostCode: { type: String, optional: true, max: 255 },\n  billingStateProvince: { type: String, optional: true, max: 255 },\n  billingStreet: { type: String, optional: true, max: 255 },\n  customerId: { type: String, optional: true, max: 255 },\n  deliveryAddress: { type: String, optional: true, max: 255 },\n  deliveryCity: { type: String, optional: true, max: 255 },\n  deliveryCountry: { type: String, optional: true, max: 255 },\n  deliveryProvince: { type: String, optional: true, max: 255 },\n  locale: { type: String, allowedValues: ['vi', 'en'] },\n  orderId: { type: String, max: 50 },\n  receiverEmail: { type: String, max: 255, regEx: SimpleSchema.RegEx.Email },\n  paymentMethod: {\n    type: String,\n    allowedValues: [\n      'NL',\n      'VISA',\n      'MASTER',\n      'JCB',\n      'ATM_ONLINE',\n      'ATM_OFFLINE',\n      'NH_OFFLINE',\n      'TTVP',\n      'CREDIT_CARD_PREPAID',\n      'IB_ONLINE'\n    ]\n  },\n  bankCode: {\n    type: String,\n    optional: true,\n    max: 50,\n    custom() {\n      let shouldBeRequired = false;\n      const method = this.field('paymentMethod').value;\n      if (\n        [\n          'ATM_ONLINE',\n          'ATM_OFFLINE',\n          'NH_OFFLINE',\n          'CREDIT_CARD_PREPAID'\n        ].indexOf(method) > -1\n      ) {\n        shouldBeRequired = true;\n      }\n\n      if (shouldBeRequired && (this.value == null || this.value === '')) {\n        return SimpleSchema.ErrorTypes.REQUIRED;\n      }\n\n      // field is valid\n      return undefined;\n    }\n  },\n  paymentType: { type: String, optional: true, allowedValues: ['1', '2'] },\n  orderInfo: { type: String, optional: true, max: 500 },\n  taxAmount: { type: SimpleSchema.Integer, optional: true },\n  discountAmount: { type: SimpleSchema.Integer, optional: true },\n  feeShipping: { type: SimpleSchema.Integer, optional: true },\n  customerEmail: { type: String, max: 255, regEx: SimpleSchema.RegEx.Email },\n  customerPhone: { type: String, max: 255 },\n  customerName: { type: String, max: 255 },\n  returnUrl: { type: String, max: 255 },\n  cancelUrl: { type: String, max: 255, optional: true },\n  timeLimit: { type: SimpleSchema.Integer, optional: true }, // minutes\n  affiliateCode: { type: String, max: 255, optional: true },\n  totalItem: { type: String, optional: true },\n  transactionId: { type: String, max: 50 },\n  nganluongSecretKey: { type: String, max: 32 },\n  nganluongMerchant: { type: String, max: 16 },\n  nganluongCommand: { type: String, max: 32 },\n  nganluongVersion: { type: String, max: 3 }\n});\n\nNganLuong.configSchema = new SimpleSchema({\n  paymentGateway: { type: String, regEx: SimpleSchema.RegEx.Url },\n  merchant: { type: String },\n  receiverEmail: { type: String },\n  secureSecret: { type: String }\n});\n// should not be changed\nNganLuong.VERSION = '3.1';\nNganLuong.COMMAND = 'SetExpressCheckout';\n// nganluong only support VND\nNganLuong.CURRENCY_VND = 'vnd';\nNganLuong.LOCALE_EN = 'en';\nNganLuong.LOCALE_VN = 'vi';\n\nexport { NganLuong };\n"],"file":"ngan-luong.js"}